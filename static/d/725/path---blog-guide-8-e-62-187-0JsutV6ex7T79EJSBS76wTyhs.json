{"data":{"markdownRemark":{"html":"<p><em>Phần 8</em></p>\n<h2>Slug Field?</h2>\n<p>Slug field là một cách để tạo ra url cho một bài blog bất kỳ. Ví dụ: bài blog demo chúng ta làm trong bài trước có thể sẽ được đặt tại <code>http://tên-miền-blog.com/demo</code>.</p>\n<p>Cách chúng ta sinh slug field rất đơn giản. Với tất cả các file Markdown nằm trong thư mục <code>posts</code>, chúng ta sẽ thu gọn đường dẫn của nó tính từ gốc là <code>posts</code>. Ví dụ với file như sau:</p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/96da0c513656424f769977c4c54c3a8a/ffc89/file.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 296px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 36.486486486486484%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAA8klEQVQoz42R3U6DQBBG+wYty0+3wCJlKwtSCgiCidELTbw0Ua98/wc5kqaJ2NTai5PZZCYn38zOXNfFsR2k79PrnJebht5LeFxuSD0fe+x7I+4Bx3F+1WNm+8ehqcOIVhuyhaR0FUq4zK0FQog9U9mfwumQsG2aruXt8wNTFLR3HVVVcdt2DMNAZszZdD8JJ+sopcjzjETHmNygtSa+iolUhFzKy4TTFRZzi0hLXr8azMOO6/uSpE7Jn2qCdYgt7AtueJRSSo91vMJXAUGsRkLCJGKl/LPpTgqt8ce17/FehuT9luK5Y1MbzLAl2aX/Cr8BmYe3lwUz92YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"file\"\n        title=\"\"\n        src=\"/static/96da0c513656424f769977c4c54c3a8a/ffc89/file.png\"\n        srcset=\"/static/96da0c513656424f769977c4c54c3a8a/cf440/file.png 148w,\n/static/96da0c513656424f769977c4c54c3a8a/d2d38/file.png 295w,\n/static/96da0c513656424f769977c4c54c3a8a/ffc89/file.png 296w\"\n        sizes=\"(max-width: 296px) 100vw, 296px\"\n      />\n  </span>\n  </a></p>\n<p>slug field của bài blog này sẽ là <code>/blog-guide-1/</code>. Rất đơn giản</p>\n<p>Để tạo slug field, ta viết đoạn code sau vào file <code>gatsby-node.js</code></p>\n<pre><code class=\"language-js\">const { createFilePath } = require(`gatsby-source-filesystem`)\n\nexports.onCreateNode = ({ node, getNode, actions }) => {\n    const { createNodeField } = actions\n    if (node.internal.type === `MarkdownRemark`) {\n        const slug = createFilePath({ node, getNode, basePath: `posts` })\n        createNodeField({\n            node,\n            name: `slug`,\n            value: slug,\n        })\n    }\n}\n</code></pre>\n<h2>Page?</h2>\n<p>Các bài blog đã được load vào và có thể truy vấn được, nhưng để xem được nó chúng ta phải tạo ra các page từ bài blog đó.</p>\n<p>Các bài blog đều có chung một bố cục, chỉ khác nhau về nội dung. Vì vậy chúng ta có thể tạo cho nó một mẫu (template) và tự động điền các thông tin của bài blog vào các vị trí thích hợp trong mỗi trang.\nTạo một thư mục ở trong <code>src</code> có tên là <code>templates</code>. Tạo trong đó một file <code>blog-post.js</code> với nội dung như sau:</p>\n<pre><code class=\"language-jsx\">import React from \"react\"\nimport Helmet from \"react-helmet\"\nimport { graphql } from \"gatsby\"\n\nexport default function Template({ data }) {\n    const { markdownRemark: post } = data\n    return (\n        &#x3C;div>\n            &#x3C;Helmet title={`Blog - ${post.frontmatter.title}`} />\n            &#x3C;div>\n                &#x3C;h1>{post.frontmatter.title}&#x3C;/h1>\n                &#x3C;div dangerouslySetInnerHTML={{ __html: post.html }} />\n            &#x3C;/div>\n        &#x3C;/div>\n    )\n}\nexport const query = graphql`\n    query($path: String!) {\n        markdownRemark(fields: { slug: { eq: $path } }) {\n            html\n            frontmatter {\n                date\n                title\n            }\n            fields {\n                slug\n            }\n        }\n    }\n`\n</code></pre>\n<p>Bây giờ chúng ta sẽ tạo các page với template này. Điền đoạn code sau vào file <code>gatsby-node.js</code></p>\n<pre><code class=\"language-js\">const path = require(\"path\")\nexports.createPages = ({ boundActionCreators, graphql }) => {\n    const { createPage } = boundActionCreators\n    const blogPostTemplate = path.resolve(`src/templates/blog-post.js`)\n    return graphql(`\n        {\n            allMarkdownRemark(\n                sort: { order: DESC, fields: [frontmatter___date] }\n                limit: 1000\n            ) {\n                edges {\n                    node {\n                        excerpt(pruneLength: 250)\n                        html\n                        id\n                        frontmatter {\n                            date\n                            title\n                        }\n                        fields {\n                            slug\n                        }\n                    }\n                }\n            }\n        }\n    `).then(result => {\n        if (result[\"errors\"]) {\n            return Promise.reject(result[\"errors\"])\n        }\n        result.data[\"allMarkdownRemark\"][\"edges\"].forEach(({ node }) => {\n            createPage({\n                path: node.fields[\"slug\"],\n                component: blogPostTemplate\n            })\n        })\n    })\n}\n</code></pre>\n<p>Bạn có thể cần restart lại <code>gatsby develop</code> để nó có hiệu lực.\nNếu bây giờ bạn đến địa chỉ <code>localhost:8000/demo</code>, bạn sẽ đọc được bài blog của mình.</p>\n<p>Trong bài tiếp theo mình sẽ hướng dẫn bạn tạo danh sách bài viết ở trang chủ.</p>","frontmatter":{"date":"2019-04-26T00:00:00.000Z","title":"Tôi đã làm page blog này như thế nào?"},"fields":{"slug":"/blog-guide-8/"}}},"pageContext":{"isCreatedByStatefulCreatePages":false}}